<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Makefile repo example"><link rel=icon href=assets/images/favicon.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-8.0.5"><title>Readme - Makefile Hello World</title><link rel=stylesheet href=assets/stylesheets/main.a617204b.min.css><link rel=stylesheet href=assets/stylesheets/palette.9204c3b2.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head><body dir=ltr data-md-color-scheme=slate data-md-color-primary data-md-color-accent><input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off><input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off><label class=md-overlay for=__drawer></label><div data-md-component=skip><a href=#makefile-hello-world class=md-skip> Skip to content </a></div><div data-md-component=announce></div><header class=md-header data-md-component=header><nav class="md-header__inner md-grid" aria-label=Header><a href=. title="Makefile Hello World" class="md-header__button md-logo" aria-label="Makefile Hello World" data-md-component=logo><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg></a><label class="md-header__button md-icon" for=__drawer><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> Makefile Hello World </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> Readme </span></div></div></div><label class="md-header__button md-icon" for=__search><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required><label class="md-search__icon md-icon" for=__search><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg></label><nav class=md-search__options aria-label=Search><button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg></button></nav></form><div class=md-search__output><div class=md-search__scrollwrap data-md-scrollfix><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta> Initializing search </div><ol class=md-search-result__list></ol></div></div></div></div></div><div class=md-header__source><a href=https://github.com/xsc27/example-repo-shell/ title="Go to repository" class=md-source data-md-component=source><div class="md-source__icon md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div><div class=md-source__repository> xsc27/example-repo-shell </div></a></div></nav></header><div class=md-container data-md-component=container><nav class=md-tabs aria-label=Tabs data-md-component=tabs><div class="md-tabs__inner md-grid"><ul class=md-tabs__list><li class=md-tabs__item><a href=readme.html class="md-tabs__link md-tabs__link--active"> Home </a></li></ul></div></nav><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a href=. title="Makefile Hello World" class="md-nav__button md-logo" aria-label="Makefile Hello World" data-md-component=logo><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg></a> Makefile Hello World </label><div class=md-nav__source><a href=https://github.com/xsc27/example-repo-shell/ title="Go to repository" class=md-source data-md-component=source><div class="md-source__icon md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div><div class=md-source__repository> xsc27/example-repo-shell </div></a></div><ul class=md-nav__list data-md-scrollfix><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1 checked><label class=md-nav__link for=__nav_1> Home <span class="md-nav__icon md-icon"></span></label><nav class=md-nav aria-label=Home data-md-level=1><label class=md-nav__title for=__nav_1><span class="md-nav__icon md-icon"></span> Home </label><ul class=md-nav__list data-md-scrollfix><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc><label class="md-nav__link md-nav__link--active" for=__toc> Readme <span class="md-nav__icon md-icon"></span></label><a href=readme.html class="md-nav__link md-nav__link--active"> Readme </a><nav class="md-nav md-nav--secondary" aria-label="Table of contents"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents </label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a href=#usage class=md-nav__link> Usage </a><nav class=md-nav aria-label=Usage><ul class=md-nav__list><li class=md-nav__item><a href=#wo-arguments class=md-nav__link> w/o Arguments </a></li><li class=md-nav__item><a href=#w-arguments class=md-nav__link> w/ Arguments </a></li></ul></nav></li><li class=md-nav__item><a href=#build class=md-nav__link> Build </a><nav class=md-nav aria-label=Build><ul class=md-nav__list><li class=md-nav__item><a href=#artifact class=md-nav__link> Artifact </a></li><li class=md-nav__item><a href=#container-image class=md-nav__link> Container Image </a></li><li class=md-nav__item><a href=#documentation class=md-nav__link> Documentation </a><nav class=md-nav aria-label=Documentation><ul class=md-nav__list><li class=md-nav__item><a href=#setup class=md-nav__link> Setup </a></li></ul></nav></li></ul></nav></li><li class=md-nav__item><a href=#tests class=md-nav__link> Tests </a><nav class=md-nav aria-label=Tests><ul class=md-nav__list><li class=md-nav__item><a href=#lint class=md-nav__link> Lint </a></li><li class=md-nav__item><a href=#unit class=md-nav__link> Unit </a></li><li class=md-nav__item><a href=#container class=md-nav__link> Container </a></li></ul></nav></li></ul></nav></li><li class=md-nav__item><a href=changelog.html class=md-nav__link> Changelog </a></li><li class=md-nav__item><a href=license.html class=md-nav__link> License </a></li></ul></nav></li></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><a href=https://github.com/xsc27/example-repo-shell/edit/master/docs/readme.md title="Edit this page" class="md-content__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg></a><p><a href=https://github.com/xsc27/example-repo-shell/actions/workflows/ci.yaml><img alt=CI src=https://github.com/xsc27/example-repo-shell/actions/workflows/ci.yaml/badge.svg></a></p><h1 id=makefile-hello-world>Makefile Hello World<a class=headerlink href=#makefile-hello-world title="Permanent link">&para;</a></h1><p>This is an example of a repository layout for shell scripts and container images.</p><ul><li>Build with <a href=https://www.gnu.org/software/make/ >GNU Make</a></li><li>Lint with <a href=https://pre-commit.com/ >pre-commit</a><ul><li>GitHub Actions workflows (<a href=https://github.com/rhysd/actionlint>Actionlint</a>)</li><li>Dockerfile <a href=https://github.com/hadolint/hadolint>Haskell Dockerfile Linter</a></li><li>Markdown (<a href=https://github.com/executablebooks/mdformat>Mdformat</a>)</li><li>Conventional Commits (<a href=https://commitlint.js.org>commitlint</a>)</li><li>Shell scripts (<a href=https://github.com/koalaman/shellcheck>ShellCheck</a> and <a href=https://github.com/lovesegfault/beautysh>Beautysh</a>)</li></ul></li><li>Build container images <a href=https://www.docker.com/ >Docker</a></li><li>Test container images <a href=https://goss.rocks>goss</a></li><li>Publish tests result in CI and PR comment</li><li>Run CI platform <a href=https://docs.github.com/en/actions>GitHub Actions</a></li><li>Publish documentation to <a href=https://docs.github.com/en/pages/getting-started-with-github-pages/about-github-pages>GitHub Pages</a> with <a href=https://www.mkdocs.org/ >MkDocs</a></li><li>Release via (leave only 1 enabled in the workflow):<ul><li>Merge PR from branch <code>v*</code></li><li>Push tag <code>v*</code></li><li>Run manual workflow</li><li>Push to default branch to generate CalVer</li></ul></li></ul><h2 id=usage>Usage<a class=headerlink href=#usage title="Permanent link">&para;</a></h2><h3 id=wo-arguments>w/o Arguments<a class=headerlink href=#wo-arguments title="Permanent link">&para;</a></h3><div class=highlight><pre><span></span><code>❯ ./prog.sh
Hello World!
</code></pre></div><h3 id=w-arguments>w/ Arguments<a class=headerlink href=#w-arguments title="Permanent link">&para;</a></h3><div class=highlight><pre><span></span><code>❯ ./src/prog.sh you there
Hello you there!
</code></pre></div><h2 id=build>Build<a class=headerlink href=#build title="Permanent link">&para;</a></h2><h3 id=artifact>Artifact<a class=headerlink href=#artifact title="Permanent link">&para;</a></h3><p>This is a pseudo step for demostration purposes. Here is where binary artifacts would be created.</p><div class=highlight><pre><span></span><code>make build
</code></pre></div><h3 id=container-image>Container Image<a class=headerlink href=#container-image title="Permanent link">&para;</a></h3><p>Create a <a href=https://www.docker.com/ >Docker</a> container image tagged with the current short sha.</p><div class=highlight><pre><span></span><code>make build-container

<span class=c1># Override tag</span>
make build-container <span class=nv>CONTAINER</span><span class=o>=</span><span class=s1>&#39;private_registry/my_image:latest&#39;</span>
</code></pre></div><h3 id=documentation>Documentation<a class=headerlink href=#documentation title="Permanent link">&para;</a></h3><p>Documentation is built with <a href=https://www.mkdocs.org/ >MkDocs</a> and the <a href=https://squidfunk.github.io/mkdocs-material/ >Material</a> theme.</p><div class=highlight><pre><span></span><code><span class=c1># Compile content</span>
make docs

<span class=c1># Serve locally</span>
make docs <span class=nv>CMD</span><span class=o>=</span>serve
</code></pre></div><h4 id=setup>Setup<a class=headerlink href=#setup title="Permanent link">&para;</a></h4><p>Recommonded setup is with <a href=https://github.com/pypa/pipx>pipx</a>.</p><div class=highlight><pre><span></span><code>pipx install --pip-args <span class=s1>&#39;-r requirements-docs.in&#39;</span> mkdocs
</code></pre></div><h2 id=tests>Tests<a class=headerlink href=#tests title="Permanent link">&para;</a></h2><h3 id=lint>Lint<a class=headerlink href=#lint title="Permanent link">&para;</a></h3><p>Linting is performed with <a href=https://pre-commit.com/ >pre-commit</a>. <a href=https://www.docker.com/ >Docker</a> and <a href=https://github.com/koalaman/shellcheck>shellcheck</a> are required.</p><div class=highlight><pre><span></span><code>make lint
</code></pre></div><h3 id=unit>Unit<a class=headerlink href=#unit title="Permanent link">&para;</a></h3><p>The tests leverage the <a href=https://github.com/bats-core/bats-core>Bats</a> framework.</p><div class=highlight><pre><span></span><code>make <span class=nb>test</span>
</code></pre></div><h3 id=container>Container<a class=headerlink href=#container title="Permanent link">&para;</a></h3><p>This builds a container image with <a href=https://www.docker.com/ >Docker</a> and validates it with <a href=https://goss.rocks>goss</a>.</p><p>By default, the <code>make</code> will first look for <code>goss-linux-amd64</code> under the current directory. See the <code>dgoss</code> <a href=https://github.com/aelsabbahy/goss/tree/master/extras/dgoss#installation>documentation</a> for more details.</p><div class=highlight><pre><span></span><code>make test-container

<span class=c1># Specify locations of `goss`</span>
make test-container <span class=nv>GOSS_FILES_PATH</span><span class=o>=</span><span class=s2>&quot;</span><span class=si>${</span><span class=nv>HOME</span><span class=si>}</span><span class=s2>/Downloads/goss-linux-amd64&quot;</span>
</code></pre></div><h1 id=license>License<a class=headerlink href=#license title="Permanent link">&para;</a></h1><p>Copyright 2021 Carlos Meza</p><p>Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p><div class=highlight><pre><span></span><code> http://www.apache.org/licenses/LICENSE-2.0
</code></pre></div><p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p></article></div></div><a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a></main><footer class=md-footer><nav class="md-footer__inner md-grid" aria-label=Footer><a href=changelog.html class="md-footer__link md-footer__link--next" aria-label="Next: Changelog" rel=next><div class=md-footer__title><div class=md-ellipsis><span class=md-footer__direction> Next </span> Changelog </div></div><div class="md-footer__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg></div></a></nav><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright></div></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><script id=__config type=application/json>{"base": ".", "features": ["navigation.expand", "navigation.indexes", "navigation.instant", "navigation.tabs", "navigation.top", "search.highlight", "toc.integrate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.cefbb252.min.js"}</script><script src=assets/javascripts/bundle.a5f8ea78.min.js></script></body></html>